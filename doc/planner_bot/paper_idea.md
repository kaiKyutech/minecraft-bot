# 議論の要約：LLMとPlanner Botによる「意識と無意識の分離」アーキテクチャ

我々がたどり着いた結論は、LLM（戦略脳）とPlanner Bot（戦術実行）を組み合わせたハイブリッド・アーキテクチャが、文明シミュレーションのような「カオス空間」における自律エージェントの最適解である、というものです。

---

## 1. ハイブリッド・アーキテクチャの基本設計

エージェントの「知能」と「身体」を、APIを通じて明確に分離します。

### LLM（大脳・意識）
* **役割：** 高次元の戦略的思考、**設計図（Blueprint）の生成**、計画、社会的判断。
* **処理速度：** 遅い（数秒に1回）。
* **責務：** `!info` で世界を観測し、「次に何をすべきか」を決定する。

### Planner Bot (小脳・無意識・手足)
* **役割：** 低次元の戦術的実行、**設計図の自動実行**、高頻度なイレギュラー対応。
* **処理速度：** 速い（リアルタイム）。
* **責務：** LLMから受け取った「抽象的な命令」を、失敗しないように（＝イレギュラーを吸収しながら）実行する。

---

## 2. 課題：「GOAPが創発を妨げる」という誤解

当初、「GOAP（`!goal`）で行動を定義すると、LLMが"発明"できなくなり、創発が妨げられるのではないか」という懸念がありました。

**解決：**
創発は**レイヤー（階層）**で分けて考えます。

* **戦術レイヤー（GOAP）：** `!goal craft_pickaxe`（ピッケル作成）の"実行方法"には創発は起きません。これは「自動化された筋肉の記憶」であり、**創発させることが目的ではありません**。
* **戦略レイヤー（LLM）：** **「いつ、どの`!goal`を呼び出すか」**、**「どの設計図を作るか」**という高次の意思決定こそが、**創発が起きるべき場所**です。

---

## 3. 「学習」と「失敗」のメカニズム（最重要）

LLMが「現実」から学ぶためのフィードバックループの設計です。

* **悪い設計:** GOAPの失敗ログ `diagnosis: { missing: iron }` だけをLLMに渡す。
    * → LLMは「`!goal get_iron`」とオウム返しするだけになる。
* **優れた設計（我々の結論）：**
    1.  LLMが `!goal` を実行し、失敗する。
    2.  LLM（脳）は、**複数の情報**を**同時に**受け取る。
        * `（A）diagnosis（失敗ログ）`: "鉱石が`air`になっていた"
        * `（B）scanBlocks（環境情報）`: "その座標にBotBがいる"
    3.  LLMの「仕事」は、(A)と(B)を組み合わせて**「推論」**することです。
        * **LLMの推論（創発）：** 「タスクが失敗した。理由は鉱石が消えたからだ。そして、環境を見るとBotBがそこにいる。...**結論：BotBに横取りされた**」

これは「オウム返し」ではなく、**高次の「社会的学習」**です。

---

## 4. 「発明」のプロセス（デッドロックの解消）

「GOAPにない新しいもの（例：TNTキャノン）はどうやって作るのか？」というデッドロックは、LLMの「2つの実行モード」で解決されます。

### モード1：無意識モード (GOAP `!goal ...`)
* **役割：** 「筋肉の記憶」による自動化。
* **LLMの命令：** `!goal inventory.stone_pickaxe:1`（ピッケルが欲しい、と"念じる"）
* **ボットの動作：** GOAP（小脳）が**自動的に**手足（プリミティブAPI）を動かし、結果を返す。
* **用途：** クラフト、採掘、精錬などの**「既知の退屈な作業」**。

### モード2：意識から無意識への委任モード (Blueprint `!buildFromBlueprint ...`)
* **役割：** 「意識的な設計」と「無意識的な実行」の分離。
* **LLMの命令（意識）：**
    1.  「TNTキャノン」の**設計図（＝ブロックと座標のリスト）**を思考し、生成する。
    2.  `!buildFromBlueprint { data: [...] }` という**1つのコマンド**を呼び出す。
* **ボットの動作（無意識）：**
    1.  Planner Botは設計図を受け取り、**建築プロセス全体を自動的に実行**する。
    2.  （`!creative placeBlock`や`!navigation`を内部で呼び出す）
    3.  この実行中、LLM（意識）は解放され、会話（`newNaturalMessage`）や次の戦略立案など、**別の高次思考が可能**になる。
* **用途：** 建築、TNTキャノン、農業自動化などの**「未知の創造的な作業」**。

---

## 5. 結論：「なぜ」この設計が最適解なのか（研究仮説）

**LLMは毎秒呼べる代物ではなく、リアルタイムなカオス空間の処理（イレギュラー対応）が苦手です。**

もしLLM（脳）に「穴を避けながら歩く」や「設計図通りにブロックを1個ずつ置く」といった低レベルな実行管理をさせると、LLMの貴重な思考リソースはそれらの「作業」で使い果たされてしまいます。

### 我々のアーキテクチャの核心
GOAPと`!buildFromBlueprint`コマンドが「小脳（無意識）」として、高頻度なイレギュラー（経路探索、建築作業）を**すべて吸収（シールド）**します。

これにより、LLM（大脳）は「歩き方」や「ブロックの置き方」のような**低次の"生理的・労働的欲queue"**から完全に解放されます。
その結果、LLMは初めて、その知能のすべてを「設計図の*デザイン*」「法律の*創生*」「他者との*交渉*」といった**高次の"社会的・創造的欲求"**のためだけ
に使うことができるようになります。

---

## 研究仮説（Hypothesis）

「エージェントの低次実行タスク（生存・製作・建築）をGOAPと自動化APIによって完全に肩代わりさせ、その**"認知的負荷"**を意図的に解放すると、エージェントは自発的に**"社会的・創造的"**な高次行動（＝法の創生、複雑なシステム設計）を開始する。」

この仮説を検証することこそが、我々のプロジェクトの目的となります。